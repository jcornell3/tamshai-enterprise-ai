# Tamshai Corp Enterprise AI - Environment Variables (v1.4)
# Copy this file to .env and fill in your values

# =============================================================================
# CLAUDE API (Required for v1.4)
# =============================================================================
# Get your API key from https://console.anthropic.com/settings/keys
# v1.4: Used by MCP Gateway for SSE streaming and AI responses
CLAUDE_API_KEY=sk-ant-api03-your-key-here

# =============================================================================
# KEYCLOAK ADMIN
# =============================================================================
# REQUIRED: Set a secure password (not 'admin')
# For dev: generate with: openssl rand -base64 16
# For stage/prod: Use environment-specific secrets from GitHub Secrets
KEYCLOAK_ADMIN=admin
KEYCLOAK_ADMIN_PASSWORD=your-secure-admin-password-here

# =============================================================================
# DATABASE PASSWORDS
# =============================================================================
# Change these in production!
POSTGRES_PASSWORD=postgres_password
KEYCLOAK_DB_PASSWORD=keycloak_password
TAMSHAI_DB_PASSWORD=tamshai_password
# tamshai_app user for MCP servers (enforces RLS - no BYPASSRLS)
# The main 'tamshai' user has BYPASSRLS for identity-sync
TAMSHAI_APP_PASSWORD=tamshai_app_password
MONGODB_PASSWORD=tamshai_password

# =============================================================================
# POSTGRESQL SSL/TLS (H3 Phase 1 - Database Encryption)
# =============================================================================
# Enable SSL for PostgreSQL connections (dev: false, stage/prod: require)
# Options: true, require (enable SSL), false, prefer (disable SSL)
POSTGRES_SSL=false

# Path or content of CA certificate for SSL verification (optional)
# For GCP Cloud SQL: Use Google's root CA or the instance's server CA
# POSTGRES_SSL_CA=/path/to/ca.crt

# Reject connections to servers with untrusted certificates (default: true in prod)
# Set to 'false' only for self-signed certs in non-production environments
# POSTGRES_SSL_REJECT_UNAUTHORIZED=true

# =============================================================================
# MONGODB SSL/TLS (H3 Phase 2 - Database Encryption)
# =============================================================================
# Enable SSL for MongoDB connections (dev: false, stage/prod: true)
# Options: true, require (enable SSL), false (disable SSL)
MONGODB_SSL=false

# Path to CA certificate for SSL verification (optional)
# For MongoDB Atlas: CA is not needed (uses public CA)
# For self-hosted: Provide the CA certificate path
# MONGODB_SSL_CA=/certs/mongodb-ca.crt

# Reject connections to servers with untrusted certificates (default: true in prod)
# Set to 'false' only for self-signed certs in non-production environments
# MONGODB_SSL_REJECT_UNAUTHORIZED=true

# =============================================================================
# REDIS (Cache & Token Revocation)
# =============================================================================
# Password for Redis AUTH (required for docker-compose.secure.yml)
REDIS_PASSWORD=redis_password_change_in_production
# Rename CONFIG command for security (use random string or disable)
REDIS_CONFIG_CMD=CONFIG_DISABLED

# =============================================================================
# MINIO (S3-COMPATIBLE STORAGE)
# =============================================================================
# Change these in production!
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin

# =============================================================================
# MCP GATEWAY SECRETS
# =============================================================================
# Client secret for MCP Gateway (generated by Keycloak)
MCP_GATEWAY_CLIENT_SECRET=[REDACTED-DEV-SECRET]

# Admin API key for E2E snapshot/restore endpoints
# Used by integration tests to reset database state
E2E_ADMIN_API_KEY=e2e-test-admin-key

# =============================================================================
# MCP SERVICE SECRETS
# =============================================================================
# MCP UI service Keycloak client secret
MCP_UI_CLIENT_SECRET=mcp-ui-secret

# MCP HR service client secret for identity sync (Keycloak admin API)
MCP_HR_SERVICE_CLIENT_SECRET=hr-service-secret

# v1.5: Internal HMAC secret for MCP Gateway -> MCP Server authentication
# This prevents direct access bypass attacks. Generate with: openssl rand -hex 32
# REQUIRED for stage/prod, optional for local dev (auth bypassed when empty)
MCP_INTERNAL_SECRET=

# Integration test service account secret (for token exchange)
# Used by integration tests to authenticate with Keycloak and impersonate test users
# NOTE: This is a GitHub Secret - do NOT set here. Load with:
#   eval $(./scripts/secrets/read-github-secrets.sh --all --env)
# MCP_INTEGRATION_RUNNER_SECRET is set via environment, not .env

# =============================================================================
# GEMINI API (Optional - for AI features)
# =============================================================================
# Get your API key from https://aistudio.google.com/app/apikey
GEMINI_API_KEY=

# =============================================================================
# VAULT
# =============================================================================
# Vault dev server root token (not for production)
VAULT_DEV_ROOT_TOKEN_ID=dev-root-token

# Vault Database Secrets Engine (H5+ - Automatic Password Rotation)
# Enable automatic 30-day rotation of PostgreSQL tamshai_app password
# Prerequisites:
#   1. Run infrastructure/database/vault-user.sql to create vault user
#   2. Set these variables and run: npx ts-node scripts/vault/sync-vault.ts
# VAULT_POSTGRES_USER=vault
# VAULT_POSTGRES_PASSWORD=your-vault-postgres-password

# =============================================================================
# JWT SIGNING (FOR TESTING)
# =============================================================================
# Only used for local testing, production uses Keycloak's keys
JWT_SECRET=local-dev-secret-change-in-production

# =============================================================================
# LOG LEVELS
# =============================================================================
# Options: error, warn, info, debug
LOG_LEVEL=debug

# =============================================================================
# FEATURE FLAGS
# =============================================================================
# Enable/disable features for development
ENABLE_AUDIT_LOGGING=true
ENABLE_RATE_LIMITING=true
ENABLE_QUERY_FILTERING=true
