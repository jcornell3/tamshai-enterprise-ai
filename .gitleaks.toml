# Gitleaks configuration for Tamshai Enterprise AI
# https://github.com/gitleaks/gitleaks

title = "Tamshai Enterprise AI Secret Detection"

[extend]
# Extend the default gitleaks config
useDefault = true

# Allow paths that are known to contain non-sensitive patterns
[allowlist]
description = "Allowlisted files and patterns"

paths = [
  '''node_modules''',
  '''\.git''',
  '''\.secrets\.baseline''',
  '''pubspec\.lock''',
  '''package-lock\.json''',
  '''\.freezed\.dart''',
  '''\.g\.dart''',
  '''.*_test\.dart''',         # Flutter/Dart test files may contain fake JWTs
  '''.*\.test\.tsx?''',        # React test files
  '''.*\.spec\.tsx?''',        # React spec files
  '''sample-data/.*''',        # Sample data files contain fake IDs/keys for testing
]

regexes = [
  # Allow redacted placeholders
  '''\[REDACTED.*\]''',
  # Allow example/placeholder patterns
  '''your-.*-here''',
  '''example\.com''',
  '''localhost''',
  # Allow test fixtures
  '''test-.*-secret''',
  '''mock-.*-key''',
  # Allow keycloak_user_id fields (UUIDs, not secrets)
  '''keycloak_user_id["']?\s*[:=]\s*["'][a-f0-9-]{36}["']''',
]

# Custom rules for project-specific patterns
[[rules]]
id = "anthropic-api-key"
description = "Anthropic API Key"
regex = '''sk-ant-api\d{2}-[A-Za-z0-9_-]{40,}'''
secretGroup = 0
entropy = 3.5
keywords = ["sk-ant-api"]

[[rules]]
id = "keycloak-client-secret"
description = "Keycloak Client Secret (non-development)"
regex = '''client[_-]?secret["']?\s*[:=]\s*["']([A-Za-z0-9_-]{20,})["']'''
secretGroup = 1
entropy = 3.0
keywords = ["client_secret", "client-secret"]

# Exclude development/test patterns
[[rules.allowlists]]
paths = [
  # Test and development files that may contain placeholder secrets
  '''.*\.test\.ts''',
  '''.*\.spec\.ts''',
  '''sample-data/.*''',
]
