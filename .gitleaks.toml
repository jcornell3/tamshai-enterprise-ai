# Gitleaks configuration for Tamshai Enterprise AI
# https://github.com/gitleaks/gitleaks

title = "Tamshai Enterprise AI Secret Detection"

[extend]
# Extend the default gitleaks config
useDefault = true

# Allow paths that are known to contain non-sensitive patterns
[allowlist]
description = "Allowlisted files and patterns"

paths = [
  '''node_modules''',
  '''\.git''',
  '''pubspec\.lock''',
  '''package-lock\.json''',
  '''\.freezed\.dart''',
  '''\.g\.dart''',
  '''realm-export.*\.json''',  # Keycloak exports with development passwords are marked [REDACTED]
]

regexes = [
  # Allow redacted placeholders
  '''\[REDACTED.*\]''',
  # Allow example/placeholder patterns
  '''your-.*-here''',
  '''example\.com''',
  '''localhost''',
  # Allow test fixtures
  '''test-.*-secret''',
  '''mock-.*-key''',
]

# Custom rules for project-specific patterns
[[rules]]
id = "anthropic-api-key"
description = "Anthropic API Key"
regex = '''sk-ant-api\d{2}-[A-Za-z0-9_-]{40,}'''
secretGroup = 0
entropy = 3.5
keywords = ["sk-ant-api"]

[[rules]]
id = "keycloak-client-secret"
description = "Keycloak Client Secret (non-development)"
regex = '''client[_-]?secret["']?\s*[:=]\s*["']([A-Za-z0-9_-]{20,})["']'''
secretGroup = 1
entropy = 3.0
keywords = ["client_secret", "client-secret"]

# Exclude development/test patterns
[rules.allowlist]
regexes = [
  '''mcp-gateway-secret''',  # Known dev secret (documented)
  # password123 removed - now using environment variables for passwords
]
